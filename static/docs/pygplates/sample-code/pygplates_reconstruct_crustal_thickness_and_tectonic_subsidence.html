<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reconstruct crustal thickness and tectonic subsidence &mdash; pygplates 0.36.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Create topological features" href="pygplates_create_topological_features.html" />
    <link rel="prev" title="Find gaps and overlaps in global topological boundaries" href="pygplates_detect_topology_gaps_and_overlaps.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> pygplates
          </a>
              <div class="version">
                0.36
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pygplates_introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pygplates_getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pygplates_sample_code.html">Sample code</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../pygplates_sample_code.html#import">Import</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pygplates_sample_code.html#load-save">Load/Save</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pygplates_sample_code.html#create-query-features">Create/query features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pygplates_sample_code.html#reconstruct-features">Reconstruct features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pygplates_sample_code.html#rotations">Rotations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../pygplates_sample_code.html#topologies">Topologies</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pygplates_find_average_area_and_subducting_boundary_proportion_of_topologies.html">Find average area and subducting boundary proportion of topologies</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygplates_find_total_ridge_and_subduction_zone_lengths.html">Find the total length of ridges and subduction zones</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygplates_detect_topology_gaps_and_overlaps.html">Find gaps and overlaps in global topological boundaries</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Reconstruct crustal thickness and tectonic subsidence</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sample-code">Sample code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#details">Details</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pygplates_create_topological_features.html">Create topological features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../pygplates_sample_code.html#velocities">Velocities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pygplates_sample_code.html#spatial-proximity">Spatial proximity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pygplates_sample_code.html#isochrons">Isochrons</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pygplates_foundations.html">Foundations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pygplates_reference.html">Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pygplates</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../pygplates_sample_code.html">Sample code</a> &raquo;</li>
      <li>Reconstruct crustal thickness and tectonic subsidence</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/sample-code/pygplates_reconstruct_crustal_thickness_and_tectonic_subsidence.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="reconstruct-crustal-thickness-and-tectonic-subsidence">
<span id="pygplates-reconstruct-crustal-thickness-and-tectonic-subsidence"></span><h1>Reconstruct crustal thickness and tectonic subsidence<a class="headerlink" href="#reconstruct-crustal-thickness-and-tectonic-subsidence" title="Permalink to this headline"></a></h1>
<p>This example reconstructs (and deforms) points through topological plate polygons (and deforming networks) to find
the following quantities over a time period spanning a past geological time to present day:</p>
<ul class="simple">
<li><p>the reconstructed positions of the initial points,</p></li>
<li><p>their crustal stretching factors, and</p></li>
<li><p>their tectonic subsidences.</p></li>
</ul>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#sample-code" id="id1">Sample code</a></p></li>
<li><p><a class="reference internal" href="#details" id="id2">Details</a></p></li>
</ul>
</div>
<section id="sample-code">
<h2><a class="toc-backref" href="#id1">Sample code</a><a class="headerlink" href="#sample-code" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pygplates</span>


<span class="c1"># Create a topological model from our topological features (can be plate polygons and/or deforming networks)</span>
<span class="c1"># and rotation file(s).</span>
<span class="n">topological_model</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">TopologicalModel</span><span class="p">(</span><span class="s1">&#39;topologies.gpml&#39;</span><span class="p">,</span> <span class="s1">&#39;rotations.rot&#39;</span><span class="p">)</span>

<span class="c1"># Our reconstruction will span from 250Ma to present day in 1 Myr intervals.</span>
<span class="n">initial_time</span> <span class="o">=</span> <span class="mi">250</span>
<span class="n">time_increment</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Reconstruct the initial points through the topological model from initial time to present day.</span>
<span class="n">reconstructed_time_span</span> <span class="o">=</span> <span class="n">topological_model</span><span class="o">.</span><span class="n">reconstruct_geometry</span><span class="p">(</span>
        <span class="n">initial_points</span><span class="p">,</span>
        <span class="n">initial_time</span><span class="p">,</span>
        <span class="n">time_increment</span><span class="o">=</span><span class="n">time_increment</span><span class="p">)</span>

<span class="c1"># Get the history of reconstructed positions, crustal stretching and tectonic subsidence of the initial points from initial time to present day.</span>
<span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">initial_time</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">time_increment</span><span class="p">):</span>  <span class="c1"># initial_time, initial_time - time_increment, ..., 0</span>
    <span class="c1"># Reconstructed positions at the current &#39;time&#39;.</span>
    <span class="n">reconstructed_points</span> <span class="o">=</span> <span class="n">reconstructed_time_span</span><span class="o">.</span><span class="n">get_geometry_points</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>

    <span class="c1"># In which resolved topologies are the reconstructed positions located at the current &#39;time&#39;.</span>
    <span class="n">reconstructed_topology_point_locations</span> <span class="o">=</span> <span class="n">reconstructed_time_span</span><span class="o">.</span><span class="n">get_topology_point_locations</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>

    <span class="c1"># The crustal stretching factor and tectonic subsidence (in kms) for each point at the current &#39;time&#39;.</span>
    <span class="n">reconstructed_scalar_values</span> <span class="o">=</span> <span class="n">reconstructed_time_span</span><span class="o">.</span><span class="n">get_scalar_values</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">reconstructed_crustal_stretching_factors</span> <span class="o">=</span> <span class="n">reconstructed_scalar_values</span><span class="p">[</span><span class="n">pygplates</span><span class="o">.</span><span class="n">ScalarType</span><span class="o">.</span><span class="n">gpml_crustal_stretching_factor</span><span class="p">]</span>
    <span class="n">reconstructed_tectonic_subsidences</span> <span class="o">=</span> <span class="n">reconstructed_scalar_values</span><span class="p">[</span><span class="n">pygplates</span><span class="o">.</span><span class="n">ScalarType</span><span class="o">.</span><span class="n">gpml_tectonic_subsidence</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="details">
<h2><a class="toc-backref" href="#id2">Details</a><a class="headerlink" href="#details" title="Permalink to this headline"></a></h2>
<div class="line-block">
<div class="line">First create a <a class="reference internal" href="../generated/pygplates.TopologicalModel.html#pygplates.TopologicalModel" title="pygplates.TopologicalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">topological</span> <span class="pre">model</span></code></a> from topological features and rotation files.</div>
<div class="line">The topological features can be plate polygons and/or deforming networks.</div>
<div class="line">More than one file containing topological features can be specified here, however we’re only specifying one file.</div>
<div class="line">Also note that more than one rotation file (or even a single <a class="reference internal" href="../generated/pygplates.RotationModel.html#pygplates.RotationModel" title="pygplates.RotationModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygplates.RotationModel</span></code></a>) can be specified here,
however we’re only specifying a single rotation file.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">topological_model</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">TopologicalModel</span><span class="p">(</span><span class="s1">&#39;topologies.gpml&#39;</span><span class="p">,</span> <span class="s1">&#39;rotations.rot&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Next we get our topological model to reconstruct (and deform) our <code class="docutils literal notranslate"><span class="pre">initial_points</span></code> from their position at <code class="docutils literal notranslate"><span class="pre">initial_time</span></code>
to present day in 1 Myr intervals using <a class="reference internal" href="../generated/pygplates.TopologicalModel.html#pygplates.TopologicalModel.reconstruct_geometry" title="pygplates.TopologicalModel.reconstruct_geometry"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pygplates.TopologicalModel.reconstruct_geometry()</span></code></a>. This returns a
<a class="reference internal" href="../generated/pygplates.ReconstructedGeometryTimeSpan.html#pygplates.ReconstructedGeometryTimeSpan" title="pygplates.ReconstructedGeometryTimeSpan"><code class="xref py py-class docutils literal notranslate"><span class="pre">reconstructed</span> <span class="pre">geometry</span> <span class="pre">time</span> <span class="pre">span</span></code></a> containing a history of the reconstructed
point positions and their associated scalar values, such as crustal stretching factor and tectonic subsidence, that change over time
when passing through deforming networks. Since we did not specify the <em>initial_scalars</em> parameter, the initial crustal stretching factors
and initial tectonic subsidences will have default values (of 1.0 and 0.0 respectively) indicating no initial stretching and sea-level subsidence.
And since we did not specify the <em>deactivate_points</em> parameter, the default deactivation is used which matches GPlates
(when using ‘reconstruct by topologies’ in a green visual layer). This means any initial points on oceanic crust could get subducted and
disappear (get deactivated).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reconstructed_time_span</span> <span class="o">=</span> <span class="n">topological_model</span><span class="o">.</span><span class="n">reconstruct_geometry</span><span class="p">(</span>
        <span class="n">initial_points</span><span class="p">,</span>
        <span class="n">initial_time</span><span class="p">,</span>
        <span class="n">time_increment</span><span class="o">=</span><span class="n">time_increment</span><span class="p">)</span>
</pre></div>
</div>
<p>Get the reconstructed positions at the current <code class="docutils literal notranslate"><span class="pre">time</span></code>. Note that some of the initial points can be deactivated, in which case the number
of points in <code class="docutils literal notranslate"><span class="pre">reconstructed_points</span></code> could be less than <code class="docutils literal notranslate"><span class="pre">initial_points</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reconstructed_points</span> <span class="o">=</span> <span class="n">reconstructed_time_span</span><span class="o">.</span><span class="n">get_geometry_points</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
<p>Query in which resolved topologies the reconstructed positions are located at the current <code class="docutils literal notranslate"><span class="pre">time</span></code>.
Note that the number of values in <code class="docutils literal notranslate"><span class="pre">reconstructed_topology_point_locations</span></code> matches the number of points in <code class="docutils literal notranslate"><span class="pre">reconstructed_points</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reconstructed_topology_point_locations</span> <span class="o">=</span> <span class="n">reconstructed_time_span</span><span class="o">.</span><span class="n">get_topology_point_locations</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
<p>Extract the reconstructed/deformed crustal stretching factor and tectonic subsidence (in kms) for each point in <code class="docutils literal notranslate"><span class="pre">reconstructed_topology_point_locations</span></code>.
Note that <a class="reference internal" href="../generated/pygplates.ReconstructedGeometryTimeSpan.html#pygplates.ReconstructedGeometryTimeSpan.get_scalar_values" title="pygplates.ReconstructedGeometryTimeSpan.get_scalar_values"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pygplates.ReconstructedGeometryTimeSpan.get_scalar_values()</span></code></a> returns a Python dictionary mapping scalar types to their scalar values
(unless a specific scalar type is specified). From that dictionary we then extract the crustal stretching factor and tectonic subsidence values.
Also note that these builtin scalar types are always available (even when no initial scalar values are provided).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reconstructed_scalar_values</span> <span class="o">=</span> <span class="n">reconstructed_time_span</span><span class="o">.</span><span class="n">get_scalar_values</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<span class="n">reconstructed_crustal_stretching_factors</span> <span class="o">=</span> <span class="n">reconstructed_scalar_values</span><span class="p">[</span><span class="n">pygplates</span><span class="o">.</span><span class="n">ScalarType</span><span class="o">.</span><span class="n">gpml_crustal_stretching_factor</span><span class="p">]</span>
<span class="n">reconstructed_tectonic_subsidences</span> <span class="o">=</span> <span class="n">reconstructed_scalar_values</span><span class="p">[</span><span class="n">pygplates</span><span class="o">.</span><span class="n">ScalarType</span><span class="o">.</span><span class="n">gpml_tectonic_subsidence</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pygplates_detect_topology_gaps_and_overlaps.html" class="btn btn-neutral float-left" title="Find gaps and overlaps in global topological boundaries" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pygplates_create_topological_features.html" class="btn btn-neutral float-right" title="Create topological features" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright (C) 2003-2022 The University of Sydney, Australia
(C) 2004-2022 California Institute of Technology
(C) 2007-2022 The Geological Survey of Norway
.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>